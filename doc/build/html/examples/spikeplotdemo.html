

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SpikePlot Demo and Tutorial &mdash; neuronpy 0.1.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="neuronpy 0.1.5 documentation" href="../index.html" />
    <link rel="up" title="Examples, Demos, and Tutorials" href="index.html" />
    <link rel="prev" title="Examples, Demos, and Tutorials" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Examples, Demos, and Tutorials"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">neuronpy 0.1.5 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Examples, Demos, and Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="spikeplot-demo-and-tutorial">
<h1>SpikePlot Demo and Tutorial<a class="headerlink" href="#spikeplot-demo-and-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial illustrates how to make spike raster plots using the
<a class="reference internal" href="../spikeplot.html#module-neuronpy.graphics.spikeplot" title="neuronpy.graphics.spikeplot"><tt class="xref py py-mod docutils literal"><span class="pre">neuronpy.graphics.spikeplot</span></tt></a> module. This document also exists as an
interactive worksheet on the NEURON Sage server: <a class="reference external" href="https://nn.med.yale.edu:8000">https://nn.med.yale.edu:8000</a>.
Log onto the server and search the published worksheets for &#8220;SpikePlot demo&#8221;.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Spike trains are formatted as single vectors
(Lists or 1D numpy arrays) or as 2D vectors (List of Lists or 2D numpy arrays). The
elements of the vectors are the spike times. Plots are such that time is in the horizontal
axis and each row is a given cell.</p>
</div>
<div class="section" id="basic-example">
<h2>Basic example<a class="headerlink" href="#basic-example" title="Permalink to this headline">¶</a></h2>
<p>The following example shows the basic steps using some artificially created spikes. We
simply create a SpikePlot object then plot the spikes.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">neuronpy.graphics</span> <span class="kn">import</span> <span class="n">spikeplot</span>

<span class="n">spikes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">num_cells</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_spikes_per_cell</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c"># Make the spike data. Use a simple Poisson-like spike generator</span>
<span class="c"># (just for illustrative purposes here. Better spike generators should</span>
<span class="c"># be used in simulations).</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cells</span><span class="p">):</span>
    <span class="n">isi</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">num_spikes_per_cell</span><span class="p">)</span>
    <span class="n">spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">isi</span><span class="p">))</span>

<span class="c"># spikes is now a list of lists where each cell has a list of spike</span>
<span class="c"># times. Now, let&#39;s plot these spikes.</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s step through the details.</p>
</div>
<div class="section" id="import-the-module">
<h2>Import the module<a class="headerlink" href="#import-the-module" title="Permalink to this headline">¶</a></h2>
<p>First, import the module.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">neuronpy.graphics</span> <span class="kn">import</span> <span class="n">spikeplot</span>
</pre></div>
</div>
</div>
<div class="section" id="basic-plot">
<h2>Basic plot<a class="headerlink" href="#basic-plot" title="Permalink to this headline">¶</a></h2>
<p>Plotting spike data requires an instance of a SpikePlot object. Instantiate the object and
call <a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.plot_spikes" title="neuronpy.graphics.spikeplot.SpikePlot.plot_spikes"><tt class="xref py py-func docutils literal"><span class="pre">plot_spikes()</span></tt></a>. (The object uses a
<tt class="docutils literal"><span class="pre">savefig=True</span></tt>
option that makes drawing write to a file, which is required over the web. When using in a
dynamic mode with matplotlib, you can leave this at its default value, which is False.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span> <span class="o">=</span> <span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to noting that the tick marks are by default black vertical bars that just
touches each other, there are a few things to note about this plot. In particular,
SpikePlot uses <a class="reference external" href="http://matplotlib.sourceforge.net/">matplotlib</a> Figures. As such, this
figure takes many Matplotlib.Figure and Axes defaults.</p>
<ul class="simple">
<li>The figure size is 8x6 inches.</li>
<li>Axis tick marks are automatically generated.</li>
<li>There are no axis labels, no title, and no legends.</li>
</ul>
<p>We will add these elements and add/edit other properties of the spike plot as we progress
throug the tutorial.</p>
</div>
<div class="section" id="spikeplot-variables">
<h2>SpikePlot variables<a class="headerlink" href="#spikeplot-variables" title="Permalink to this headline">¶</a></h2>
<p>SpikePlot has several different variables below that can be set and retrieved: <a href="#id1"><span class="problematic" id="id2">:ref:`marker`_</span></a></p>
<blockquote>
<div><ul class="simple">
<li><em class="xref std std-ref">marker</em></li>
<li><em class="xref std std-ref">markercolor</em></li>
<li><em class="xref std std-ref">markerscale</em></li>
<li><em class="xref std std-ref">markeredgewidth</em></li>
<li><em class="xref std std-ref">linestyle</em></li>
<li><em class="xref std std-ref">linewidth</em></li>
<li><em class="xref std std-ref">fig_name</em></li>
<li><em class="xref std std-ref">figsize</em></li>
<li><em class="xref std std-ref">figure and axes handles</em></li>
<li><em class="xref std std-ref">Adding shaded regions</em></li>
</ul>
</div></blockquote>
<p>These variables are illustrated below. Python does not have the capability of hiding
variables, so these variables are accessible directly as <tt class="docutils literal"><span class="pre">_&lt;var_name&gt;</span></tt> (note the
underscore in front of the variable name). However, the <tt class="docutils literal"><span class="pre">set_&lt;var_name&gt;</span></tt> methods perform
error checking to help ensure that the proposed variable value is valid, so use the
accessor methods instead of setting the variable directly.</p>
<div class="section" id="marker">
<h3>marker<a class="headerlink" href="#marker" title="Permalink to this headline">¶</a></h3>
<p>By default, the marker is a vertical line. This can be changed to any valid
<a class="reference external" href="http://matplotlib.sourceforge.net/api/artist_api.html#matplotlib.lines.Line2D.set_marker">Matplotlib.lines.Line2D marker </a>.
For example, the marker can be set to circles.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Make the marker filled circles.</span>
<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this is equivalent to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_marker</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>    <span class="c"># Make all subsequent marks circles</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="markercolor">
<h3>markercolor<a class="headerlink" href="#markercolor" title="Permalink to this headline">¶</a></h3>
<p>The markercolor can be changed with any valid <a class="reference external" href="http://matplotlib.sourceforge.net/api/colors_api.html">Matplotlib color </a>. This means strings like
&#8216;red&#8217; and &#8216;blue&#8217; can be used as well as RGB tuples and html strings. This sets the
complete element to a solid color. There is no discrepancy between facecolor and edgecolor.
If horizontal lines are shown (described below), this also colors the line with the same
color.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="markerscale">
<h3>markerscale<a class="headerlink" href="#markerscale" title="Permalink to this headline">¶</a></h3>
<p>The markerscale corresponds to the height of the rows. With a default value of 1 and when
vertical bars are used as the tick marks, each row just touches the other. With a value of
0.5, the tick marks would be half as tall. In the previous examples using circle tick marks,
the marks were quite large. Setting this value to a smaller value may help that issue.
Additionally, larger values than 1 will bleed across rows, which may be desired in some
situations.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markerscale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="markeredgewidth">
<h3>markeredgewidth<a class="headerlink" href="#markeredgewidth" title="Permalink to this headline">¶</a></h3>
<p>The markeredgewidth also defines the size of the tick mark. By default, this has a value
of 1. This can be made even smaller for sharper tick marks or larger to widen the mark.
For example, here we set the width to 10.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markeredgewidth</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="linestyle">
<h3>linestyle<a class="headerlink" href="#linestyle" title="Permalink to this headline">¶</a></h3>
<p>The linestyle defines the horizontal line that is drawn across each spike train. By
default, the linestyle is <tt class="docutils literal"><span class="pre">None</span></tt> so that no lines are drawn. This can accept any
linestyle defined by <a class="reference external" href="http://matplotlib.sourceforge.net/api/artist_api.html#matplotlib.lines.Line2D.set_linestyle">Matplotlib.lines </a>,
but for the most part, either <tt class="docutils literal"><span class="pre">None</span></tt> or <tt class="docutils literal"><span class="pre">'-'</span></tt> will be used.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markerscale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="linewidth">
<h3>linewidth<a class="headerlink" href="#linewidth" title="Permalink to this headline">¶</a></h3>
<p>When the linestyle is not <tt class="docutils literal"><span class="pre">None</span></tt>, then a horizontal line is drawn. The width of that
line can be set to be different from it&#8217;s default value of 0.75.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markerscale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fig-name">
<h3>fig_name<a class="headerlink" href="#fig-name" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">fig_name</span></tt> variable is &#8220;spikeplot.png&#8221; by default. Changing this to
&#8220;&lt;filename&gt;.&lt;format&gt;&#8221; allows other options. Allowable file formats are largely determined
by the graphics backend that is used, but for the most part, png, pdf, ps, eps and svg
extensions are permitted.</p>
<p>This parameter raises an interesting point. When <tt class="docutils literal"><span class="pre">savefig=True</span></tt>,
<a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.plot_spikes" title="neuronpy.graphics.spikeplot.SpikePlot.plot_spikes"><tt class="xref py py-func docutils literal"><span class="pre">plot_spikes()</span></tt></a> writes its output to
a file, but this can be modified, as discussed later.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_fig_name</span><span class="p">(</span><span class="s">&#39;myplot.pdf&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="figsize">
<h3>figsize<a class="headerlink" href="#figsize" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">figsize</span></tt> parameter is a tuple of length 2 specifying the width and height of the
figure in inches. By default, this is 8x6 (or to the value specified in the Matplotlib
rc file). Avoid setting this value by getting the figure handle and setting the size. Use
the <a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.set_figsize" title="neuronpy.graphics.spikeplot.SpikePlot.set_figsize"><tt class="xref py py-func docutils literal"><span class="pre">set_figsize()</span></tt></a> method, or start with
the desired output size as the parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="figure-and-axes-handle">
<h3>figure and axes handle<a class="headerlink" href="#figure-and-axes-handle" title="Permalink to this headline">¶</a></h3>
<p>It is possible to pass a figure handle to the SpikePlot object as well as an axes object.
This can be useful for specifying titles, axis labels, tick marks, and general layout.</p>
<p>The following example creates a figure and axes, then sets an axes title, a x-axis label,
and removes the ticklabels and tick marks from the vertical axis.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="c"># Pre-process some figure variables</span>
<span class="n">fig_handle</span><span class="o">=</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig_handle</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Pre-formatted figure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$t$ (ms)&#39;</span><span class="p">)</span> <span class="c"># Note LaTeX</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c"># Now pass the figure handle to SpikePlot.</span>
<span class="c"># The spike_axes will be set to the first axes object assigned to the figure</span>
<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig_handle</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>Well, the title is clipped and the xlabel is not even visible. Adjust the axes size.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig_handle</span><span class="o">=</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig_handle</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Pre-formatted figure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$t$ (ms)&#39;</span><span class="p">)</span> <span class="c"># Note LaTeX</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c">#### Next lines are new</span>
<span class="n">pos</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">ymin</span><span class="o">+.</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="o">-.</span><span class="mi">15</span><span class="p">])</span>

<span class="c"># Now pass the figure handle to SpikePlot.</span>
<span class="c"># The spike_axes will be set to the first axes object assigned to the figure</span>
<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig_handle</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s better.</p>
<p>We can also work backwards by plotting the spikes and then doing some post-processing
formatting. This requires getting the figure handle and spike_axes from the SpikePlot
object and manipulating them. After any manipulation to the axes, the SpikePlot object
needs to be told so that it can adjust the spike rasters properly. Additionally, we do not
draw the figure to a file when we call
<a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.plot_spikes" title="neuronpy.graphics.spikeplot.SpikePlot.plot_spikes"><tt class="xref py py-func docutils literal"><span class="pre">plot_spikes()</span></tt></a>, which normally writes a
file. So we do not initialize SpikePlot with a <tt class="docutils literal"><span class="pre">savefig=True</span></tt>, but then write the
file later.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">()</span> <span class="c"># No need for SpikePlot to write a file yet</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>

<span class="c"># Post-processing</span>
<span class="n">fig_handle</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">get_fig</span><span class="p">()</span>
<span class="n">fig_handle</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">get_raster_axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Post-formatted figure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$t$ (ms)&#39;</span><span class="p">)</span> <span class="c"># Note LaTeX</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">pos</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">ymin</span><span class="o">+.</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="o">-.</span><span class="mi">15</span><span class="p">])</span>

<span class="c"># After modifying the spike_axes, be sure to update the SpikePlot object</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_raster_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="c"># Actually draw and write the file</span>
<span class="n">fig_handle</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">get_fig_name</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="shaded-regions">
<h3>Shaded regions<a class="headerlink" href="#shaded-regions" title="Permalink to this headline">¶</a></h3>
<p>Another useful thing to do in post-processing the figure may be to add some shaded region
as in the following example.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">patches</span>

<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">()</span> <span class="c"># No need for SpikePlot to write a file yet</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>

<span class="c"># Post-processing</span>
<span class="n">fig_handle</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">get_fig</span><span class="p">()</span>
<span class="n">fig_handle</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">get_raster_axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Post-formatted figure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$t$ (ms)&#39;</span><span class="p">)</span> <span class="c"># Note LaTeX</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">pos</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">ymin</span><span class="o">+.</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="o">-.</span><span class="mi">15</span><span class="p">])</span>

<span class="c">#### Highlight</span>
<span class="n">left</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

<span class="c"># After modifying the spike_axes, be sure to update the SpikePlot object</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_raster_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="c"># Actually draw and write the file</span>
<span class="n">fig_handle</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">get_fig_name</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="multiple-trains">
<h2>Multiple trains<a class="headerlink" href="#multiple-trains" title="Permalink to this headline">¶</a></h2>
<p>We can write multiple trains by either overlaying a second set of spikes on top of the
original set, or by stacking. This first example creates a second set of spikes and draws
them red, overlaying the black train. Under the hood, spike data and drawing formats are
overwritten with new rendering commands. This means if we called
<a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.plot_spikes" title="neuronpy.graphics.spikeplot.SpikePlot.plot_spikes"><tt class="xref py py-func docutils literal"><span class="pre">plot_spikes()</span></tt></a> with more spikes, it would
erase the previous data. To get around this, we now call
<a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.plot_spikes" title="neuronpy.graphics.spikeplot.SpikePlot.plot_spikes"><tt class="xref py py-func docutils literal"><span class="pre">plot_spikes()</span></tt></a> with different labels.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Create a second list of spikes</span>
<span class="n">spikes2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">num_cells</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_spikes_per_cell</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c"># Make the spike data. Use a simple Poisson-like spike generator</span>
<span class="c"># (just for illustrative purposes here. Better spike generators should</span>
<span class="c"># be used in simulations).</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cells</span><span class="p">):</span>
    <span class="n">isi</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">num_spikes_per_cell</span><span class="p">)</span>
    <span class="n">spikes2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">isi</span><span class="p">))</span>
</pre></div>
</div>
<p>Plot with different labels.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Draw the first spikes as before, but set draw to False so that we do</span>
<span class="c"># not draw to the screen with this plot_spikes call, but wait until</span>
<span class="c"># later, when we have drawn all spike traces to draw to the screen.</span>
<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;black spikes&#39;</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Make subsequent marks red</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;red spikes&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To stack plots, you have to provide a <tt class="docutils literal"><span class="pre">cell_offset</span></tt> value on any subsequent sets.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Make the marker filled circles.</span>
<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markerscale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_marker</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>

<span class="c"># Set draw to false so that we do not draw to the screen now, but</span>
<span class="c"># wait until later, when we have drawn all spike traces.</span>
<span class="c"># Make new marks black</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># Make subsequent marks red</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>

<span class="c"># Set refresh to False so that old marks are not erased.</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">cell_offset</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="large-data-and-telescoping">
<h3>Large Data and telescoping<a class="headerlink" href="#large-data-and-telescoping" title="Permalink to this headline">¶</a></h3>
<p>In general, if you are navigating large data, you may try and load it all into the figure
and then specify the subset of columns (a chunk of time) to see. This is possible using
<a class="reference internal" href="../spikeplot.html#neuronpy.graphics.spikeplot.SpikePlot.update_xlim" title="neuronpy.graphics.spikeplot.SpikePlot.update_xlim"><tt class="xref py py-func docutils literal"><span class="pre">update_xlim()</span></tt></a> method. The following example
illustrates this.</p>
<div class="highlight-python"><pre>sp=spikeplot.SpikePlot(savefig=True)
sp.plot_spikes(spikes)
sp.update_xlim((100, 200)</pre>
</div>
</div>
</div>
<div class="section" id="spike-time-histograms">
<h2>Spike time histograms<a class="headerlink" href="#spike-time-histograms" title="Permalink to this headline">¶</a></h2>
<p>Adding a spike time histogram to an existing plot is quite easy.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>Adding the argument <tt class="docutils literal"><span class="pre">sth_ratio=0.2</span></tt> in the code above creates a spike time histogram
and sets it to occupy 20% of the vertical space. Try other values, such as 0.5. The bins
are quantized by 1 ms by default. The code below grabs the spike time histogram object and
sets it&#8217;s bars&#8217; timestep (dt) to 10 ms.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<p>There are four types of bar styles for the histogram: &#8216;bar&#8217; (default), &#8216;stepfilled&#8217;,
&#8216;step&#8217;, and &#8216;lineto&#8217;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;stepfilled&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;step&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;lineto&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;step&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;black spikes&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;red spikes&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The histogram can also be considered a 1D vector of values. In this case, it can be
filtered for various effect. This is useful in cases where a small time window (dt) is used
for the histogram, but where you want to blur or smear the spikes in time with a gaussian
or linear function, say. The mechanism used to filter is a 1D kernel. Kernels should
sum to 1, but you can turn this flag off if you want. The following example makes a
linearly decaying kernel that makes each spike reach 0 in 10 ms. This example also only
uses a few spikes in one spike train so that you can see the effects of modifying dt and
the kernel origin, which can be in the range <img class="math" src="../_images/math/ab052ed3de87524251cb0b11fab975d9de0cdcb7.png" alt="\left[-\mathrm{len}(\mathrm{kernel})/2,
\mathrm{len}(\mathrm{kernel})/2\right]"/>, or the values &#8216;left&#8217;, &#8216;center&#8217;, and &#8216;right&#8217;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="c"># Small time window</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="n">sth</span><span class="o">.</span><span class="n">_dt</span><span class="p">)</span> <span class="c"># Linear ramp over 10 ms</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">kernel</span><span class="p">))</span> <span class="c"># Normalize</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_kernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;lineto&#39;</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_origin</span><span class="p">(</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="c"># Small time window</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="n">sth</span><span class="o">.</span><span class="n">_dt</span><span class="p">)</span> <span class="c"># Linear ramp over 10 ms</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">kernel</span><span class="p">))</span> <span class="c"># Normalize</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_kernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;lineto&#39;</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_origin</span><span class="p">(</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">neuronpy.math</span> <span class="kn">import</span> <span class="n">kernel</span>
<span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">dt</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="c"># Small time window</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">gauss_1d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_kernel</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;lineto&#39;</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_origin</span><span class="p">(</span><span class="s">&#39;center&#39;</span><span class="p">)</span>

<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sp</span><span class="o">=</span><span class="n">spikeplot</span><span class="o">.</span><span class="n">SpikePlot</span><span class="p">(</span><span class="n">sth_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sth</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_sth</span><span class="p">()</span>
<span class="n">dt</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_dt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="c"># Small time window</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">gauss_1d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_kernel</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;lineto&#39;</span><span class="p">)</span>
<span class="n">sth</span><span class="o">.</span><span class="n">set_origin</span><span class="p">(</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;black spikes&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">set_markercolor</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="n">sp</span><span class="o">.</span><span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;red spikes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">SpikePlot Demo and Tutorial</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#basic-example">Basic example</a></li>
<li><a class="reference internal" href="#import-the-module">Import the module</a></li>
<li><a class="reference internal" href="#basic-plot">Basic plot</a></li>
<li><a class="reference internal" href="#spikeplot-variables">SpikePlot variables</a><ul>
<li><a class="reference internal" href="#marker">marker</a></li>
<li><a class="reference internal" href="#markercolor">markercolor</a></li>
<li><a class="reference internal" href="#markerscale">markerscale</a></li>
<li><a class="reference internal" href="#markeredgewidth">markeredgewidth</a></li>
<li><a class="reference internal" href="#linestyle">linestyle</a></li>
<li><a class="reference internal" href="#linewidth">linewidth</a></li>
<li><a class="reference internal" href="#fig-name">fig_name</a></li>
<li><a class="reference internal" href="#figsize">figsize</a></li>
<li><a class="reference internal" href="#figure-and-axes-handle">figure and axes handle</a></li>
<li><a class="reference internal" href="#shaded-regions">Shaded regions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiple-trains">Multiple trains</a><ul>
<li><a class="reference internal" href="#large-data-and-telescoping">Large Data and telescoping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#spike-time-histograms">Spike time histograms</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Examples, Demos, and Tutorials</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/examples/spikeplotdemo.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Examples, Demos, and Tutorials"
             >previous</a> |</li>
        <li><a href="../index.html">neuronpy 0.1.5 documentation</a> &raquo;</li>
          <li><a href="index.html" >Examples, Demos, and Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Thomas McTavish.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>